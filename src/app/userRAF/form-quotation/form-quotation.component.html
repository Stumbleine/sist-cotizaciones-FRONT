<div style="display: flex; justify-content: center;  align-items: center;" >
    <div class="container">

            <div class="header">
                <div style="width: 50px; padding-left: 20px;">
                    <mat-icon  style="font-size: 40px; color: white; margin-top: 15px;">feed</mat-icon></div>
                <div class="header__title">
                    
                    <h2 style="line-height: 10px; margin-top: 5px;">FORMULARIO DE COTIZACIÓN</h2>
                    <p style="line-height: 0px;">Moneda (Bs)</p>
                </div>
                <span class="example-spacer"></span>
                <div class="header--actions">
                    <button mat-button matTooltip="Subir cotizacion escaneado" class="btn-icons" (click)="openUploader()">
                        <mat-icon *ngIf="dataFile==null">upload_file</mat-icon>
                        <mat-icon *ngIf="dataFile!=null">task</mat-icon>
                    </button>
                    <button mat-button matTooltip="Imprimir formulario" class="btn-icons" (click)="printForm()">
                        <mat-icon >print</mat-icon>
                    </button>
                    <button mat-raised-button style="margin-right: 25px; margin-left: 15px;" (click)="openGLink()"> ENVIAR </button>
                </div>
            </div>



            <div style="padding:10px;">
                <div *ngIf="!thereIsBusiness()">
                    <h3>Información de la empresa</h3>
                    <div class="info-empresa" style="padding: 15px; ">
                        <h3 id="solicitante">Razon social: <p> {{business?.name}} </p></h3>
                        <h3 id="solicitante">NIT: <p>{{business?.nit}}</p></h3>
                        <h3 id="solicitante">e-mail: <p>{{business?.eMail}}</p></h3>
                        <h3 id="solicitante">Teléfono: <p>{{business?.phone}}</p></h3>
                        <h3 id="solicitante">Dirección: <p>{{business?.adress}}</p></h3>

                    </div>
                </div>

                <mat-divider *ngIf="!thereIsBusiness()"></mat-divider>

                <form class="form-base" [formGroup]="quotationForm" #formDirectiveNew="ngForm" (ngSubmit)="saveQuotation(quotationForm.value,formDirectiveNew)">
                    
                    <h3>Información de la cotización</h3>

                    <div class="form-base__s1" >
                        <div class="form-base__s1--fds" style=" width: 100%;">
                            <div *ngIf="thereIsBusiness()">
                                <mat-form-field appearance="outline">
                                <mat-label>Razon social</mat-label>
                                <input matInput placeholder="Placeholder"formControlName='businessCompanyName' required>
                                <mat-error class="form__validation--size">campo razon social es requerido</mat-error>
                              </mat-form-field>
                            </div>
                            <div  >
                                <mat-form-field  appearance="outline">
                                    <mat-label>Forma de pago</mat-label>
                                    <mat-select formControlName='wayOfPayment' required>
                                        <mat-option value="Crédito">A Crédito</mat-option>
                                        <mat-option value="Contado">Al Contado</mat-option>
                                        <mat-option value="Contado y Crédito">Al Contado y a Crédito</mat-option>
                                    </mat-select>
                                    <mat-error >seleccionar forma de pago</mat-error>
                                </mat-form-field>
                            </div>
                            <div>

                              <mat-form-field  appearance="outline">
                                <mat-label>Tiempo de entrega</mat-label>
                                <input matInput placeholder="Ingrese tiempo de entrega(días)" formControlName='deliveryTerm'required type="number"
                                min="1" pattern="^[0-9]+" onkeypress='return event.charCode >= 48 && event.charCode <= 57'>
                                <mat-error class="form__validation--size">campo Tiempo de entrega es requerido</mat-error>

                              </mat-form-field>
                            </div>

                        </div >
                        <div class="form-base__s1--fds"  style=" width: 100%;">

                            
                            <div>
                                <mat-form-field  appearance="outline">
                                    <mat-label>Tiempo de garantia</mat-label>
                                    <input matInput placeholder="Ingrese tiempo de garantia(días)" formControlName='garantyTerm' type="number"
                                     min="1" pattern="^[0-9]+" onkeypress='return event.charCode >= 48 && event.charCode <= 57'>
                                <mat-error class="form__validation--size">campo tiempo de garantia es requerido</mat-error>
                                  </mat-form-field>
                            </div>
                            <div  >                           
                                <mat-form-field  appearance="outline">
                                    <mat-label>Validez de oferta</mat-label>
                                    <input matInput placeholder="Ingrese Validez de oferta"  type="date" formControlName='offValidation'> 
                                <mat-error class="form__validation--size">campo Validez de oferta es requerido</mat-error>
                                  </mat-form-field>
                            </div>
                        </div>

                    </div>

                    <mat-divider></mat-divider>
                    <h3>Detalle del item/articulo/bien/servicio</h3>

                    <div class="form-base__s2">
                        
                        <div style=" width: 85%;  display: grid;
                        padding: 25px; " >
                            <table mat-table [dataSource]="dataSource" class="mat-elevation-z5" style="width: 100%;">
                                
        
                                    <ng-container matColumnDef="index" >
                                        <th mat-header-cell *matHeaderCellDef style="text-align: center;font-weight: bold;"> Nro </th>
                                        <td mat-cell *matCellDef="let element;let i=index;" style="text-align: center;" > {{i+1}} </td>
                                        <td mat-footer-cell *matFooterCellDef> TOTAL </td>
                                    </ng-container>
                
                                    <ng-container *ngFor="let columna of columnas" matColumnDef="{{columna.name}}" >
                                      <th mat-header-cell *matHeaderCellDef style="text-align: center;  min-width: 85px; font-weight: bold;"> {{columna.titulo}}  </th>
        
        
                                      <td mat-cell *matCellDef="let element" style="min-width: 85px;text-align: center;"> {{element[columna.name]}} </td>
                                      <td mat-footer-cell *matFooterCellDef></td> 
                                    </ng-container>
        
        
                                    <ng-container matColumnDef="unitPrice" >
                                        <th mat-header-cell *matHeaderCellDef style="text-align: center;font-weight: bold;"> PRECIO UNITARIO </th>
        
                                        <td mat-cell *matCellDef="let element" style="text-align: center;" > 
                                            <input type="number" [(ngModel)]="element.unitPrice" [ngModelOptions]="{standalone: true}"
                                             [name]="element.idPriceQuotationDetail" (change)="metodo()" > </td>
                                        <td mat-footer-cell *matFooterCellDef></td>
                                    </ng-container>
        
        
        
        
                                    <ng-container matColumnDef="totalPrice" >
                                        <th mat-header-cell *matHeaderCellDef style="text-align: center;font-weight: bold;"> SUBTOTAL </th>
        
                                        <td mat-cell *matCellDef="let element" style="text-align: center;" > {{element.totalPrice}} </td>
                                        <td mat-footer-cell *matFooterCellDef> {{ getTotalCost() | currency:"Bs."}}</td>
                                    </ng-container>
        
                                    <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
                                    <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
                                    <tr mat-footer-row *matFooterRowDef="displayedColumns; sticky: true"></tr>
                                  </table>
                        </div>
                        <!--a>  Text fields para tabla   </a-->
                        <!-- <form class="s2__fields" [formGroup]="itemForm" #formDirective="ngForm"  (ngSubmit)="saveItem(itemForm.value, formDirective)">

                              <div >
                                <mat-form-field  appearance="outline">
                                    <mat-label>Cantidad</mat-label>
                                    <input matInput placeholder="Ingrese la cantidad" type="number" matInput 
                                    formControlName='quantity'
                                    min="1" pattern="^[0-9]+" onkeypress='return event.charCode >= 48 && event.charCode <= 57'
                                    required>
                                    <mat-error >campo cantidad es requerido</mat-error>
                                  </mat-form-field>
                              </div>
                              <div>
                                <mat-form-field appearance="outline">
                                    <mat-label>Unidad</mat-label>
                                    <input matInput placeholder="Ingrese Unidad" formControlName='unit' required>
                                    <mat-error >campo unidad es requerido</mat-error>
                                  </mat-form-field>
                              </div>
                              <div>
                                <mat-form-field appearance="outline">
                                    <mat-label>Detalle</mat-label>
                                    <input matInput placeholder="Ingrese un detalle" formControlName='description' required>
                                    <mat-error >campo detalle es requerido</mat-error>
                                  </mat-form-field>
                              </div>
                              <div>
                                <mat-form-field appearance="outline">
                                    <mat-label>P. Unitario</mat-label>
                                    <input matInput placeholder="Ingrese precio unitario" formControlName='unitPrice'type="number" required value="0.00"
                                    min="0" pattern="^[0-9]+(.[0-9]+)?$" onkeypress='return event.charCode >= 48 && event.charCode <= 57 || event.charCode==44 || event.charCode==46'
                                    step=".01">
                                    <mat-error >campo Precio Unitario es requerido</mat-error>
                                  </mat-form-field>
                              </div>
                            <div  style="width: 100%; padding-top: 15px; padding-bottom: 20px; text-align: center;">
                                <button mat-raised-button class="btn-raised"[disabled]="itemForm.invalid">
                                    AÑADIR ITEM
                                </button>
                            </div>
                        </form> -->
                    </div>
                    <div style="padding-left: 50px;padding-top: 20px;padding-bottom: 25px;">
                        <p>Ingrese un comentario:</p>
                        <mat-form-field appearance="outline" style="width: 70%; height: 40%;">
                            <mat-label>Comentario</mat-label>
                            <input matInput placeholder="Ingrese un comentario" formControlName='commentary' >
                            <mat-error class="form__validation--size">campo comentario es requerido</mat-error>
                          </mat-form-field>
                    </div>
                    <mat-divider></mat-divider>

                <div  class="form-actions">
                    <div *ngIf="validPDFupload==true">
                        <p style="color: #ff4848; margin-right: 15px;">
                            Aun no se subio un documento escaneado de la cotización.
                        </p>
                    </div>
                    <button mat-button style="color: #ff4848;margin-right: 15px;" (click)="openDialogCancel();" type="button"> CANCELAR</button>
                    <button mat-raised-button class="btn-raised" style="margin-right: 25px;" [disabled]="quotationForm.invalid" type="submit" >
                        GUARDAR
                    </button>
                </div>
                </form>
                
            </div>
    </div>
    
</div>

<style>
        .snackSuccess{
        background: var(--state-color-5);
        
    }
    h3{
        color: var(--txt-color-subt);
        font-weight: 500;
        text-align: center;
        margin-top: 15px;
        font-size: 17px;

    }
        .container{
        width: 80%;
        min-width: 900px;
        max-width: 1300px;
        background-color: rgb(255, 255, 255);
        box-shadow: 0px 20px 50px -15px #c2c2c2;
        height: 100%;
        border-radius: 10px;
            margin-top: 50px;
            margin-bottom: 100px;
    }
    .header{
        display: flex;
        height: 75px; width: 100%;
        background-color: var(--txt-color-title2);
        
    }
    .header__title {
        text-align: start;
        align-self: center;
        color: white;
        min-width: 300px;
    }
    .header--actions{
        display: flex;
        align-items: center;
    }
    .btn-icons mat-icon{
         color: white;
         font-size: 30px;
         margin-top: -7px;
    }

    .example-spacer {
        flex: 1 1 auto;
    }

    .info-empresa h3{

        margin-left: 15px;
        display: flex; 
        line-height: 10px; 
        font-size: 16px;
    }
    .info-empresa p{        
        margin-left: 15px;
        font-weight: lighter;}
    /*contenido form-base*/
    .form-base__s1{
        padding: 15px;
        text-align: center;
    }
    .form-base__s1 div{
        padding-top: 15px;
        padding-bottom: 15px;
        justify-content: center;
        display: inline-flex;
    }

    .form-base__s1--fds div{
        width: 25%;
        padding-left: 35px;
        padding-right: 35px;
    }
    .form-base__s1--fds mat-form-field{
        width: 100%;
    }
    /*tabla*/
    .form-base__s2{
        display: flex;
        padding: 15px;
        margin-bottom: 15px;
    }
    tr.mat-footer-row {
    font-weight: bold;
    background-color: #ebebeb;
}
    /*fields*/
    .s2__fields{
        width: 30%;
        border-radius: 10px; border:  1px solid;
        border-color: #e0e0e0;

        text-align: center;
    }
    .s2__fields mat-form-field{
        width: 70%;
        margin-top: 15px;
        min-width: 220px;
    }

    /*Botones*/
    .form-actions{
        text-align: end; width: 100%;
        padding-top: 25px;padding-bottom: 25px;
    }
    .btn-raised {
         color: white;
        background-color: var(--btn-color-pri);
}

</style>
