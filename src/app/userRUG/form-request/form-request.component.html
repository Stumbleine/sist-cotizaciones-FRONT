<div class="form">
  <form class="form__content " [formGroup]="requestForm" #formDirectiveNew="ngForm" (ngSubmit)="saveRequest(requestForm.value,formDirectiveNew)">
    <div class="form__title">
      <p>PEDIDO </p>

    
    </div>  
    <div class="form__dateTypeSigla">
           
          <div class="form__type">
            <label for="typeid">TIPO: </label>
            <mat-form-field appearance="fill" class="form__components--padding">
              <mat-label>Seleccionar</mat-label>
              <mat-select id="typeid" formControlName='type' required>
                <mat-option value="Solicitud de Compra">Solicitud de Compra</mat-option>
                <mat-option value="Solicitud de Servicio">Solicitud de Servicio</mat-option>
                <mat-option value="Solicitud de Compra y Servicio">Solicitud de Compra y Servicio</mat-option>
              </mat-select>
              <mat-error class="form__validation--size">seleccionar tipo de solicitud</mat-error>
            </mat-form-field>
            <div>
              <label for="proyect">SOLICITADO POR PROYECTO:</label>
              <mat-form-field appearance="outline" class="form__components--padding">
                <mat-label></mat-label>
                <input matInput placeholder="Ingrese siglas del Proyecto" id="proyect" formControlName='initials' oninput="this.value = this.value.toUpperCase()"  pattern="[A-Za-z_-]{1,15}">
                <mat-error class="form__validation--size">Campo no valido. Solo se permiten letras y operadores "-" o "_"</mat-error>
              </mat-form-field>
          
            </div>  
          </div>
          <div class="form__date">
            <h2>FECHA DE EMISIÓN</h2>
            <mat-label>{{currentDate | date:'dd/MM/yyyy'}}</mat-label>
        </div>
      </div>
           
    
      <div class="form__agregarProduct">
        <div class="form__table">
          <table mat-table [dataSource]="dataSource" class="mat-elevation-z5" >

            <ng-container *ngFor="let column of columns" matColumnDef="{{column.name}}">
              <th mat-header-cell *matHeaderCellDef> {{column.titulo}} </th>
              <td mat-cell *matCellDef="let Product"> {{Product[column.name]}} </td>
            </ng-container>

          
            <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
            <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
          </table>
          <mat-paginator  style="box-shadow: 0px 10px 20px -10px #818181;" [pageSizeOptions]="[3, 5]" showFirstLastButtons></mat-paginator>
        </div>

        <form class="form__product" [formGroup]="productForm" #formDirective="ngForm"  (ngSubmit)="saveProduct(productForm.value, formDirective)">
                
                <mat-form-field appearance="fill" class="form__product--textfield">
                  <mat-label>Cantidad</mat-label>
                  <input type="number" matInput 
                        formControlName='quantity'
                        min="1" pattern="^[0-9]+" onkeypress='return event.charCode >= 48 && event.charCode <= 57'
                        required>
                        <mat-error  class="form__validation--size">campo cantidad es requerido</mat-error>
                </mat-form-field>
                <mat-form-field appearance="fill"class="form__product--textfield">
                  <mat-label>Unidad</mat-label>
                  <input matInput formControlName='unit' required>
                  <mat-error class="form__validation--size">campo unidad es requerido</mat-error>
                </mat-form-field>
                <mat-form-field appearance="fill"class="form__product--textfield">
                  <mat-label>Detalle</mat-label>
                  <input matInput formControlName='description' required>
                  <mat-error class="form__validation--size">campo detalle es requerido</mat-error>
                </mat-form-field>
                <div class="form__components--padding">
                  <button mat-raised-button 
                  [disabled]="productForm.invalid">AÑADIR ITEM</button>
                </div>
                
              </form>
      </div>
          <div class="form__total">
            <label for="total">TOTAL ESTIMADO: </label>
            <mat-form-field appearance="outline" >
              <mat-label></mat-label>
              <input matInput placeholder="Ingrese el Total Estimado" id="total" formControlName='estimatedAmount' type="number" min="1" pattern="^[0-9]+" onkeypress='return event.charCode >= 48 && event.charCode <= 57' required>
              <mat-error class="form__validation--size">este campo es requerido</mat-error>
            </mat-form-field>
          </div>
          <div class="form__justify">
            <mat-form-field appearance="outline" class="form__justify">
              <mat-label class="form__type"> JUSTIFICACION</mat-label>
              <input matInput placeholder="Agregar justificacion" class="form__justify" formControlName='justification' required>
              <mat-error class="form__validation--size">este campo es requerido</mat-error>
            </mat-form-field>
          </div>

        <div class="form__buttons">
          <button class="btn-text"mat-button  routerLink='' >CANCELAR</button>
          <button class="btn-raised "mat-raised-button  [disabled]="requestForm.invalid" type="submit" >ENVIAR</button>
        </div>
  </form>

</div>
